<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.1/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-+0n0xVW2eSR5OomGNYDnhzAbDsOXxcvSN1TPprVMTNDbiYZCxYbOOl7+AMvyTG2x" crossorigin="anonymous">

    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js"
        integrity="sha384-IQsoLXl5PILFhosVNubq5LC7Qb9DXgDA9i+tQ8Zj3iwWAwPtgFTxbJ8NT4GN1R8p"
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.1/dist/js/bootstrap.min.js"
        integrity="sha384-Atwg2Pkwv9vp0ygtn1JAojH0nYbwNJLPhwyoVbhoPwBhjQPR5VtM2+xf0Uwh9KtT"
        crossorigin="anonymous"></script>

    <script src="https://code.jquery.com/jquery-3.6.0.js"></script>
</head>
<style>
    /* body  */
    body,
    html {
        background-color: black;
        /* z-index: 10; */

        overflow-x: auto;
        color: white;
        width: 5400px;
        height: 100%;
    }


    /* 컨텐츠 부분 */
    #container {
        width: 95%;
        height: 95%;
        margin-left: 150px;
        overflow-x: auto;
        overflow-y: hidden;
        z-index: 8;

    }


    #content {
        width: 400px;
        height: 75%;
        color: white;
        display: inline-block;
        overflow: hidden;
        margin-left: 100px;
        border-radius: 25%;
    }

    #content li {
        position: relative;
        z-index: 3;
    }

    #content:hover li img {
        width: 400px;
        height: 300px;
        animation: scrollimg 5s infinite;
        /* animation-duration: 5s;
        animation-iteration-count: infinite; */
    }

    #content #inner {
        /* background-color: black; */
        width: 400px;
        height: 70%;
        border-radius: 25%;
        /* border: solid 2px white; */
        position: absolute;
        z-index: 5;
        top: 1%;
        margin-left: 0;
        text-align: center;
        opacity: 0.7;
        transition: all 0.3s ease-in-out;
    }

    #content #inner p {
        padding-top: 300px;
    }


    #content div:hover,
    header #menuGo:hover,
    #goBack:hover,
    nav div ul li:hover {
        cursor: pointer;

    }

    #content #inner:hover {
        opacity: 0;
        transform: translateY(-1500px);
    }

    @keyframes scrollimg {
        0% {
            transform: translateY(0);
        }

        100% {
            transform: translateY(-290%);
        }
    }

    div #startvote {
        margin-left: 45%;
        position: fixed;
        width: 300px;
        height: 100px;
        background-color: black;
        font-size: 20px;
        border-radius: 35%;
        color: white;

    }

    div #voting {
        margin-left: 15%;
        width: 300px;
        height: 100px;
        background-color: black;
        font-size: 20px;
        border-radius: 45%;
        color: white;
    }


    /* 메뉴 */
    header {
        width: 100px;
        height: 95%;
        left: 0;
        position: fixed;
        border: 2px solid white;
        z-index: 8;
        background-color: black;
    }

    header #head {
        transform: rotate(90deg);
        margin-top: 100%;
        padding-top: 10%;
        padding-left: 90%;
        text-align: center;
        white-space: nowrap;
    }

    #menuList {
        position: fixed;
        width: 500px;
        height: 95%;
        margin-left: 100px;
        z-index: 10;
        display: none;
        border: 3px solid white;
        background-color: black;
    }

    #menuList div {
        padding-top: 10%;
        padding-left: 20%;
        font-size: 30px;
    }

    nav div ul li {
        padding-top: 20%;
        list-style: none;
    }

    /* 투표 중일때 투표버튼이랑 컨텐츠 div를 넣어놓을 div */
    .votingdiv {
        width: 400px;
        height: 100%;
        color: white;
        display: inline-block;
        overflow: hidden;
        margin-left: 100px;
        border: solid 2px white;
        border-radius: 25%;
    }
    #mainImg {
        margin-bottom: 300px;
    }
</style>

<body>
    <header>
        <p id="menuGo"><img src="images/menu1.png" alt="" width="50px" height="50px" style="margin-left: 20px;"
                id="menuImg" onclick="changeImg();"></p>
        <p id="head">게임을 투표하세요!</p>
    </header>
    <nav id="menuList">
        <div>
            <ul>
                <li id="login" onclick="fn_move('login.html', 1);">Log_in</li>
                <li id="logout" onclick="fn_move('로그아웃', 2);">Log_out</li>
                <li id="join" onclick="fn_move('register.html', 3);">회원가입</li>
                <li id="board" onclick="fn_move('방명록보기.html', 4);">게시판</li>
            </ul>
        </div>
    </nav>

    <div id="container">
        <div id="content" class="game" onclick="new_Form('images/lol');">
            <li><img src="images/lolLogo.png" alt="" width="400px" height="200px" id="mainImg"></li>
            <li><img src="images/lolback.png" alt="" width="400px"></li>
            <li><img src="images/lolback2.png" alt="" width="400px"></li>
            <div id="inner">
                <p id="gameName">리그오브레전드</p>
            </div>
        </div>
        <div id="content" class="game" onclick="new_Form('images/sudden');">
            <li><img src="images/suddenLogo.png" alt="" width="400px" height="200px" id="mainImg"></li>
            <li><img src="images/suddenback.png" alt="" width="400px"></li>
            <li><img src="images/sudddenback2.png" alt="" width="400px"></li>
            <div id="inner">
                <p id="gameName">서든어택</p>
            </div>
        </div>
        <div id="content" class="game" onclick="new_Form('images/fifa');">
            <li><img src="images/fifaLogo.png" alt="" width="400px"  height="200px"id="mainImg"></li>
            <li><img src="images/fifaback.png" alt="" width="400px"></li>
            <li><img src="images/fifaback2.png" alt="" width="400px"></li>
            <div id="inner">
                <p id="gameName">피파</p>
            </div>
        </div>
        <div id="content" class="game" onclick="new_Form('images/star');">
            <li><img src="images/starLogo.png" alt="" width="400px" height="200px" id="mainImg"></li>
            <li><img src="images/starback.png" alt="" width="400px"></li>
            <li><img src="images/starback2.png" alt="" width="400px"></li>
            <div id="inner">
                <p id="gameName">스타크래프트</p>
            </div>
        </div>
        <div id="content" class="game" onclick="new_Form('images/kart');">
            <li><img src="images/kartLogo.png" alt="" width="400px" height="200px" id="mainImg"></li>
            <li><img src="images/kartback.png" alt="" width="400px"></li>
            <li><img src="images/kartback2.png" alt="" width="400px"></li>
            <div id="inner">
                <p id="gameName">카트라이더</p>
            </div>
        </div>
        <div id="content" class="game" onclick="new_Form('images/maple');">
            <li><img src="images/mapleLogo.png" alt="" width="400px" height="200px" id="mainImg"></li>
            <li><img src="images/mapleback.png" alt="" width="400px"></li>
            <li><img src="images/mapleback2.png" alt="" width="400px"></li>
            <div id="inner">
                <p id="gameName">메이플</p>
            </div>
        </div>
        <div id="content" class="game" onclick="new_Form('images/battle');">
            <li><img src="images/battleLogo.png" alt="" width="400px" height="200px" id="mainImg"></li>
            <li><img src="images/battleback.png" alt="" width="400px"></li>
            <li><img src="images/battleback2.png" alt="" width="400px"></li>
            <div id="inner">
                <p id="gameName">배틀그라운드</p>
            </div>
        </div>
        <div id="content" class="game" onclick="new_Form('images/over');">
            <li><img src="images/overLogo.png" alt="" width="400px" height="200px" id="mainImg"></li>
            <li><img src="images/overback.png" alt="" width="400px"></li>
            <li><img src="images/overback2.png" alt="" width="400px"></li>
            <div id="inner">
                <p id="gameName">오버워치</p>
            </div>
        </div>
        <br>
        <input id="startvote" type="button" value="시작하기" onclick="vote('투표시작', 0);">
    </div>
</body>
<script>
    var voteQ = 0;
    // 가로화면 기능
    $(document).ready(function () {
        $("body #container").on("mousewheel", function (e) {
            e.preventDefault();
            var wheelDelta = e.originalEvent.wheelDelta;
            console.log(wheelDelta);
            var div = document.getElementById("container");
            div.scrollBy(-700, 0);
        });
    });

    // 메뉴 바 설정
    var cnt = 1;
    var menuBar = document.getElementById("menuGo");
    var menuImg = document.getElementById("menuImg");
    var menuList = document.getElementById("menuList");
    function changeImg() {
        cnt++;
        if (cnt > 2) {
            cnt = 1;
        }
        if (cnt == 1) {
            menuImg.src = "images/menu1.png";
            menuList.style.display = "none";
        } else if (cnt == 2) {
            menuImg.src = "images/menu2.png";

            menuList.style.display = "block";
        }
    }

    // 전적검색창으로 이동.
    function new_Form(imgurl) {
        var expire = new Date();
        expire.setTime(expire.getTime() + (6660000));
        SetCookie("gameName", imgurl, expire);
        openWin = window.open('form2.html', '_blank, left=300, top=300, width=500, height=300');
    }

    // 투표
    // 랜덤 생성
    var random = new Array(8);
    var gameIndex = 0;
    for (var i = 0; i < random.length; i++) {
        random[i] = Math.ceil(Math.random() * 8) - 1;
        for (var j = 0; j < i; j++) {
            if (random[i] == random[j]) {
                i--;
            }
        }
    }

    // div 객체 생성
    var divList = new Array(8);
    for (var i = 0; i < random.length; i++) {
        divList[i] = document.getElementsByClassName("game")[random[i]];
    }
    var bigDiv = document.getElementById('container');

    function vote(i, Ccnt) {        
        voteQ = localStorage.getItem(GetCookie("username") + "VoteCnt");
        if (GetCookie("username") != null && voteQ == null) {        
            // 배열 자르기
            if (isNaN(i) == false) {
                if (Ccnt == 1) {
                    random.splice(i + 1, 1);
                    divList.splice(i + 1, 1);
                } else if (Ccnt == 2) {
                    random.splice(i - 1, 1);
                    divList.splice(i - 1, 1);
                }
            }

            // container div 설정
            bigDiv.innerHTML = "";
            bigDiv.style.width = "90%";
            bigDiv.style.position = "absolute";

            // 선언
            var head = document.getElementById('head');
            // cnt
            if (divList.length >= 8) {
                head.innerHTML = "8강";
            }
            if (divList.length == 4) {
                head.innerHTML = "4강";
                gameIndex = 0;
            } else if (divList.length == 2) {
                head.innerHTML = "결승전";
                gameIndex = 0;
            } else if (divList.length == 1) {           // 우승
                head.innerHTML = "우승";
                gameIndex = 0;
                Ccnt = 5;
                var smallDiv1 = document.createElement("div");
                smallDiv1.append(divList[gameIndex]);
                divList[gameIndex].style.marginLeft = "0px";
                smallDiv1.setAttribute("class", "votingdiv");
                bigDiv.append(smallDiv1);
                localStorage.setItem(GetCookie("username") + "VoteCnt", random);            // 동일 유저가 투표하는 것 방지
                if (localStorage.getItem("game" + random) == null) {      // 게임별 로컬스토리지 생성
                    localStorage.setItem("game" + random, 1);
                } else {
                    var cnt = Number(localStorage.getItem("game" + random));
                    localStorage.setItem("game" + random, cnt + 1);
                }
                $(document).ready(function () {
                    alert($("#gameName").text() + "가 우승했습니다!");
                });

                setTimeout(function () {
                    window.open('방명록보기.html', '_blank, width=700, height=700');
                }, 2000);

            }

            if (Ccnt != 5) {
                // 투표 버튼 설정
                var smallDiv1 = document.createElement("div");
                var smallDiv2 = document.createElement("div");
                var btn1 = document.createElement("input");
                var btn2 = document.createElement("input");
                btn1.setAttribute("id", "voting");
                btn1.setAttribute("type", "button");
                btn1.setAttribute("value", "투표하기");
                btn1.setAttribute("onclick", 'vote(' + gameIndex + ', 1 )');

                btn2.setAttribute("id", "voting");
                btn2.setAttribute("type", "button");
                btn2.setAttribute("value", "투표하기");
                btn2.setAttribute("onclick", 'vote(' + (gameIndex + 1) + ', 2 )');

                divList[gameIndex].style.marginLeft = "0px";
                divList[gameIndex + 1].style.marginLeft = "0px";

                smallDiv1.append(divList[gameIndex]);
                smallDiv1.append(btn1);
                smallDiv2.append(divList[gameIndex + 1]);
                smallDiv2.append(btn2);
                smallDiv1.setAttribute("class", "votingdiv");
                smallDiv2.setAttribute("class", "votingdiv");
                bigDiv.append(smallDiv1);
                bigDiv.append(smallDiv2);
                gameIndex++;
            }
            // 돌아가기 버튼 설정
            var back = document.createElement("img");

            back.src = "images/back.png";
            bigDiv.append(back);
            back.style.right = '3%';
            back.style.top = "1%";
            back.style.position = "absolute";
            back.style.width = '30px';
            back.style.height = '30px';
            back.setAttribute("onclick", "location.reload()");
            back.setAttribute("id", "goBack");
        } else {
            alert("이미 투표를 하셨거나 로그인을 해야합니다.");
        }
    }

    // 
    function fn_move(url, num) {
        if (num == 1 || num == 3) {
            window.open(url, 'childForm', 'width=700, height=700');
        } else if (num == 4) {
            if (GetCookie("username") != null) {
                window.open(url, '_blank, width=700, height=700');
            } else {
                alert("로그인을 해야 이용이 가능합니다.");
            }
        }
    }

    // 쿠키 가져오기
    function GetCookie(name) {
        var str = name + "=";
        var pairs = document.cookie.split(";");
        for (var i = 0; i < pairs.length; i++) {
            var pair = pairs[i].trim();
            var unit = pair.split("=");
            if (unit[0] == name)
                return unescape(unit[1]);
        }
        return null;
    }

    // 쿠키 만들기
    function SetCookie(name, value, expire) {
        var cookieStr = name + "=" + value +
            ((expire == null) ? "" : (";expiers=" + expire.toGMTString()));     //삼항연산자
        document.cookie = cookieStr;
    }

    // 쿠키 삭제하기
    function DeleteCookie(name) {
        document.cookie = name + '=; expires=Thu, 01 Jan 1999 00:00:10 GMT;';
    }

    // 로그인 하면 로그인 지우고 유저명 띄우기
    if (GetCookie("username") != null) {      // 쿠키가 있다면// 로그인을 했다면
        var login = document.getElementById("login");
        var join = document.getElementById("join");
        join.innerHTML = "";
        login.innerHTML = GetCookie("username") + "님";
        login.onclick = null;
        $(document).ready(function () {
            $("#logout").on('click', function () {
                DeleteCookie("username");
                location.reload();
            });
        });
    }
</script>

</html>
